

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Transformations &mdash; Altair 2.0.0rc1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/altair-plot.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/altair-gallery.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Altair 2.0.0rc1 documentation" href="../index.html"/>
        <link rel="next" title="Selections: Building Blocks of Interactions" href="selections.html"/>
        <link rel="prev" title="Configuring Visualizations" href="config.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Altair
          

          
            
            <img src="../_static/altair-logo-light.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.0.0rc1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/starting.html">Basic Statistical Visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="importing.html">Importing Altair</a></li>
<li class="toctree-l1"><a class="reference internal" href="display.html">Displaying Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Specifying Data in Altair</a></li>
<li class="toctree-l1"><a class="reference internal" href="encoding.html">Encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="marks.html">Marks</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuring Visualizations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Transformations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#altair-expressions">Altair Expressions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="selections.html">Selections: Building Blocks of Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="compound_charts.html">Compound Charts: Layer, HConcat, VConcat, Repeat, Facet</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving_charts.html">Saving Altair Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Case Studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../case_studies/exploring-weather.html">Exploring Seattle Weather</a></li>
</ul>
<p class="caption"><span class="caption-text">Gallery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Example Gallery</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Altair</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Data Transformations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user_guide/transform.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-transformations">
<span id="user-guide-transformations"></span><h1>Data Transformations<a class="headerlink" href="#data-transformations" title="Permalink to this headline">¶</a></h1>
<p>It is often necessary to transform or filter data in the process of visualizing
it. In Altair you can do this one of two ways:</p>
<ol class="arabic simple">
<li>Before the chart definition, using standard Pandas data transformations.</li>
<li>Within the chart definition, using Vega-Lite’s data transformation tools.</li>
</ol>
<p>In most cases, we suggest that you use the first approach, because it is more
straightforward to those who are familiar with data manipulation in Python, and
because the Pandas package offers much more flexibility than Vega-Lite in
available data manipulations.</p>
<p>The second approach becomes useful when the data source is not a dataframe, but,
for example, a URL pointer to a JSON or CSV file. It can also be useful in a
compound chart where different views of the dataset require different
transformations.</p>
<p>This second approach – specifying data transformations within the chart itself
– can be accomplished using the <code class="docutils literal"><span class="pre">transform_*</span></code> methods of top-level objects:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-meth docutils literal"><span class="pre">transform()</span></code></td>
<td>Generic transform; passes keywords to any of the following methods.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-meth docutils literal"><span class="pre">transform_aggregate()</span></code></td>
<td>Create a new data column by aggregating an existing column.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-meth docutils literal"><span class="pre">transform_bin()</span></code></td>
<td>Create a new data column by binning an existing column.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-meth docutils literal"><span class="pre">transform_calculate()</span></code></td>
<td>Create a new data column using an arithmetic calculation on an existing column.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-meth docutils literal"><span class="pre">transform_filter()</span></code></td>
<td>Select a subset of data based on a condition.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-meth docutils literal"><span class="pre">transform_lookup()</span></code></td>
<td>One-sided join of two datasets based on a lookup key.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-meth docutils literal"><span class="pre">transform_timeunit()</span></code></td>
<td>Discretize/group a date by a time unit (day, month, year, etc.)</td>
</tr>
</tbody>
</table>
<p>We will see some examples of these transforms in the following sections.</p>
<div class="section" id="altair-expressions">
<span id="user-guide-expressions"></span><h2>Altair Expressions<a class="headerlink" href="#altair-expressions" title="Permalink to this headline">¶</a></h2>
<p>Transformation expressions in Vega-Lite are specified as strings of javascript
code, with a well-defined set of functions and constants available
(see Vega’s <a class="reference external" href="https://github.com/vega/vega/wiki/Expressions">Expression Documentation</a>).
For convenience when when working from Python, Altair provides an API
in the <code class="xref py py-mod docutils literal"><span class="pre">altair.expr</span></code> module to allow users to build these expressions
more idiomatically within Python.</p>
<p>So, for example, if you want to perform the following data filtration:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="s2">&quot;datum.y &lt; sin(datum.t + PI)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can instead write the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">altair.expr</span> <span class="kn">import</span> <span class="n">datum</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">PI</span>
<span class="n">chart</span><span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">datum</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">sin</span><span class="p">(</span><span class="n">datum</span><span class="o">.</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">PI</span><span class="p">)</span>
</pre></div>
</div>
<p>This approach has the benefit that syntax errors in the formula will be caught
in Python rather than in the chart renderer; you can also use Jupyter
tab-completion on the <code class="xref py py-mod docutils literal"><span class="pre">expr</span></code> module to see what functions and constants
are available.</p>
<p><em>TODO: section detailing each type of transform</em></p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="selections.html" class="btn btn-neutral float-right" title="Selections: Building Blocks of Interactions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config.html" class="btn btn-neutral" title="Configuring Visualizations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Altair Developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.0.0rc1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@3.2"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@2.3"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@3"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>